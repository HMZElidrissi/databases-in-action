"use strict";(self.webpackChunkdatabases_in_action=self.webpackChunkdatabases_in_action||[]).push([[4753],{4436:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>u,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var n=t(4848),r=t(8453);const a={sidebar_position:3},i="Testing HTTP Requests and Responses",o={id:"Testing-and-Test-Driven-Development/Testing-HTTP-Requests-and-Responses",title:"Testing HTTP Requests and Responses",description:"Testing HTTP requests and answers is critical for verifying that your Laravel application behaves correctly, especially when dealing with routes, controllers, and middleware.",source:"@site/docs/Testing-and-Test-Driven-Development/Testing-HTTP-Requests-and-Responses.md",sourceDirName:"Testing-and-Test-Driven-Development",slug:"/Testing-and-Test-Driven-Development/Testing-HTTP-Requests-and-Responses",permalink:"/databases-in-action/docs/Testing-and-Test-Driven-Development/Testing-HTTP-Requests-and-Responses",draft:!1,unlisted:!1,editUrl:"https://github.com/HMZElidrissi/databases-in-action/blob/main/docs/Testing-and-Test-Driven-Development/Testing-HTTP-Requests-and-Responses.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Writing Unit Tests with PHPUnit",permalink:"/databases-in-action/docs/Testing-and-Test-Driven-Development/Writing-Unit-Tests-with-PHPUnit"},next:{title:"Test-Driven Development (TDD) Workflow",permalink:"/databases-in-action/docs/Testing-and-Test-Driven-Development/Test-Driven-Development-Workflow"}},u={},d=[{value:"Writing Feature Tests",id:"writing-feature-tests",level:2},{value:"Simulating HTTP Requests",id:"simulating-http-requests",level:3},{value:"Making POST Requests",id:"making-post-requests",level:3},{value:"Verifying Responses",id:"verifying-responses",level:3},{value:"Testing Middleware",id:"testing-middleware",level:3}];function l(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"testing-http-requests-and-responses",children:"Testing HTTP Requests and Responses"}),"\n",(0,n.jsx)(s.p,{children:"Testing HTTP requests and answers is critical for verifying that your Laravel application behaves correctly, especially when dealing with routes, controllers, and middleware."}),"\n",(0,n.jsx)(s.p,{children:"Laravel provides a strong testing environment for feature tests, allowing you to replicate HTTP queries and validate the results. Let\u2019s get started with HTTP requests and responses in Laravel."}),"\n",(0,n.jsx)(s.h2,{id:"writing-feature-tests",children:"Writing Feature Tests"}),"\n",(0,n.jsx)(s.p,{children:"Feature tests are used to test the behavior of your application from the user's perspective. They simulate HTTP requests to your application and verify the responses returned by the server."}),"\n",(0,n.jsxs)(s.p,{children:["To create a new feature test class, you can use the ",(0,n.jsx)(s.code,{children:"make:test"})," Artisan command with the ",(0,n.jsx)(s.code,{children:"--feature"})," option. This command will generate a new feature test class in the ",(0,n.jsx)(s.code,{children:"tests/Feature"})," directory."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"php artisan make:test ExampleFeatureTest --feature\n"})}),"\n",(0,n.jsx)(s.p,{children:"Here's an example of a simple feature test that verifies the response status code of a route:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"// tests/Feature/ExampleFeatureTest.php\n\nnamespace Tests\\Feature;\n\nuse Tests\\TestCase;\n\nclass ExampleFeatureTest extends TestCase\n{\n    public function test_example_route_returns_200()\n    {\n        $response = $this->get('/example-route');\n\n        $response->assertStatus(200);\n    }\n}\n"})}),"\n",(0,n.jsx)(s.h3,{id:"simulating-http-requests",children:"Simulating HTTP Requests"}),"\n",(0,n.jsx)(s.p,{children:"Laravel provides a collection of testing aids in feauture tests to simulate HTTP queries to your site. You can use these testing aids to send GET, POST, PUT, PATCH, DELETE, and other forms of requests to your application."}),"\n",(0,n.jsx)(s.p,{children:"For example, let's assume you have a simple Laravel route that returns a JSON response:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"// routes/web.php\nRoute::get('/api/users', function ($id) {\n    $user = User::find($id);\n    return response()->json($user);\n});\n"})}),"\n",(0,n.jsxs)(s.p,{children:["You can test this route using the ",(0,n.jsx)(s.code,{children:"get"})," method in your feature test:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"// tests/Feature/UserApiTest.php\n\nnamespace Tests\\Feature;\n\nuse App\\Models\\User;\nuse Tests\\TestCase;\n\nclass UserApiTest extends TestCase\n{\n    public function test_get_user_by_id()\n    {\n        $user = User::factory()->create();\n\n        $response = $this->get('/api/users/' . $user->id);\n\n        $response->assertStatus(200)\n            ->assertJson([\n                'id' => $user->id,\n                'name' => $user->name,\n                'email' => $user->email,\n            ]);\n    }\n}\n"})}),"\n",(0,n.jsx)(s.h3,{id:"making-post-requests",children:"Making POST Requests"}),"\n",(0,n.jsx)(s.p,{children:"You can also simulate POST requests in your feature tests to test the behavior of your application when receiving form submissions or API endpoints that require data to be sent in the request body."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"Route::post('/api/users', function (Request $request) {\n    $data = $request->validate([\n        'name' => 'required|string',\n        'email' => 'required|email|unique:users,email',\n        'password' => 'required|string|min:8',\n    ]);\n    $user = User::create($data);\n    return response()->json($user);\n});\n"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"namespace Tests\\Feature;\n\nuse App\\Models\\User;\nuse Tests\\TestCase;\n\nclass UserApiTest extends TestCase\n{\n    public function test_create_user()\n    {\n        $userData = [\n            'name' => 'John Doe',\n            'email' => 'john.doe@example.com',\n            'password' => 'password123',\n        ];\n\n        $response = $this->post('/api/users', $userData);\n        $response->assertStatus(201)\n            ->assertJson($userData);\n    }\n}\n"})}),"\n",(0,n.jsx)(s.h3,{id:"verifying-responses",children:"Verifying Responses"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"assertStatus($code)"}),": Assert that the response status code matches the given code."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"assertJson($data)"}),": Assert that the response contains the given JSON data."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"assertJsonFragment($data)"}),": Assert that the response contains the given JSON fragment."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"assertJsonStructure($structure)"}),": Assert that the response JSON structure matches the given structure."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"assertSee($text)"}),": Assert that the response contains the given text."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"assertDontSee($text)"}),": Assert that the response does not contain the given text."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"testing-middleware",children:"Testing Middleware"}),"\n",(0,n.jsx)(s.p,{children:"You can also test middleware in your feature tests by adding the middleware to the route definition. This allows you to simulate requests that pass through the middleware and verify the behavior of the middleware."}),"\n",(0,n.jsx)(s.p,{children:"For example, let's assume you have a middleware that checks if the user is authenticated:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"// app/Http/Middleware/Authenticate.php\n\nnamespace App\\Http\\Middleware;\n\nuse Closure;\nuse Illuminate\\Http\\Request;\n\nclass Authenticate\n{\n    public function handle(Request $request, Closure $next)\n    {\n        if (!auth()->check()) {\n            return response('Unauthorized', 401);\n        }\n\n        return $next($request);\n    }\n}\n"})}),"\n",(0,n.jsx)(s.p,{children:"You can test this middleware by adding it to the route definition and sending a request in your feature test:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"Route::get('/api/protected', function () {\n    return response('Protected data', 200);\n})->middleware('auth');\n"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-php",children:"namespace Tests\\Feature;\n\nuse Tests\\TestCase;\n\nclass AuthMiddlewareTest extends TestCase\n{\n    public function test_protected_route_requires_authentication()\n    {\n        $response = $this->get('/api/protected');\n\n        $response->assertStatus(401);\n    }\n}\n"})})]})}function c(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>o});var n=t(6540);const r={},a=n.createContext(r);function i(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);